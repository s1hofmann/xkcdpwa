{"version":3,"sources":["components/header/header.js","components/imageshaker/Seismograph.js","config.js","components/imageshaker/imageshaker.js","components/viewer/viewer.js","capabilities.js","index.js","register-serviceworker.js"],"names":["Header","react_default","a","createElement","id","src","process","alt","className","React","Component","Seismograph","_ref","_this","this","minShakes","onShake","delay","Object","classCallCheck","startRecording","console","log","window","addEventListener","onMotionEvent","stopRecording","removeEventListener","event","x","acceleration","accelerationIncludingGravity","initValues","detectShake","previousX","current","previous","belowTimeThreshold","Math","abs","sign","currentShakes","shakeThresholdReached","lastShake","Date","now","currentConfig","dataUrl","ImageShaker","props","possibleConstructorReturn","getPrototypeOf","call","componentDidMount","updateImage","seismograph","getDataUrl","range","url","floor","random","state","maxComics","currentHistory","history","lastIndex","length","fetchPayload","then","body","setState","concat","currentIndex","fetch","response","json","catch","err","prev","idx","next","renderComic","payload","img","num","title","render","currentPayload","onClick","Viewer","header_Header","imageshaker_ImageShaker","capabilities","sw","navigator","idb","sync","ReactDOM","viewer_Viewer","document","getElementById","serviceWorker","register","registration"],"mappings":"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","file":"static/js/main.cbbd2480.chunk.js","sourcesContent":["import React from \"react\";\nimport './header.css';\n\nexport default class Header extends React.Component {\n    render() {\n        return (\n            <header>\n                <div id={\"headerContainer\"}>\n                    <img src={process.env.PUBLIC_URL + \"/img/logo.png\"} alt={\"Logo\"}/>\n                    <span className={\"title\"}>pwa</span>\n                </div>\n            </header>\n        )\n    }\n}\n","export class Seismograph {\n  constructor({ minShakes, onShake, delay }) {\n    if (typeof minShakes === \"number\") {\n      this.minShakes = minShakes;\n    } else {\n      this.minShakes = 3;\n    }\n    if (typeof onShake === \"function\") {\n      this.onShake = onShake;\n    } else {\n      this.onShake = () => {\n        console.log(\"Shake it!\");\n      };\n    }\n    this.currentShakes = null;\n    this.lastShake = Date.now();\n    this.delay = delay || 0;\n    this.previousX = null;\n  }\n\n  startRecording = () => {\n    console.log(\"Starting to record!\");\n    window.addEventListener(\"devicemotion\", this.onMotionEvent);\n  };\n\n  stopRecording = () => {\n    console.log(\"Stopping to record!\");\n    window.removeEventListener(\"devicemotion\", this.onMotionEvent);\n  };\n\n  onMotionEvent = event => {\n    let x = null;\n\n    if (\"acceleration\" in event) {\n      x = event.acceleration.x;\n    } else {\n      x = event.accelerationIncludingGravity.x;\n    }\n\n    this.initValues(x);\n\n    this.detectShake(x, this.previousX);\n  };\n\n  initValues = x => {\n    if (!this.previousX) {\n      this.previousX = x;\n    }\n  };\n\n  detectShake = (current, previous) => {\n    if (!this.belowTimeThreshold()) {\n      return;\n    }\n\n    if (Math.abs(current) > 3 && Math.sign(current) !== Math.sign(previous)) {\n      ++this.currentShakes;\n    }\n\n    previous = current;\n\n    if (this.shakeThresholdReached()) {\n      this.currentShakes = 0;\n      this.lastShake = Date.now();\n      this.onShake();\n      return true;\n    }\n  };\n\n  shakeThresholdReached = () => {\n    return this.currentShakes > this.minShakes;\n  };\n\n  belowTimeThreshold = () => {\n    return Date.now() - this.lastShake > this.delay;\n  };\n}\n","const currentConfig = {\n    dataUrl: \"https://xkcd.now.sh/\"\n};\n\nexport default currentConfig;\n","import React from \"react\";\n\nimport \"./imageshaker.css\";\nimport { Seismograph } from \"./Seismograph\";\nimport currentConfig from \"../../config\";\n\nexport default class ImageShaker extends React.Component {\n  constructor(props) {\n    super(props);\n    this.seismograph = null;\n    this.state = {\n      history: [{}],\n      currentIndex: 0\n    };\n    this.fetchPayload(this.getDataUrl()).then(body => {\n      this.setState({\n        history: [body],\n        currentIndex: this.state.history.length - 1,\n        maxComics: body.num\n      });\n    });\n  }\n\n  componentDidMount = () => {\n    this.updateImage();\n    if (!this.seismograph) {\n      this.seismograph = new Seismograph({\n        minShakes: this.props.minShakes || 3,\n        onShake: this.updateImage,\n        delay: this.props.delay || 1500\n      });\n    }\n    this.seismograph.startRecording();\n  };\n\n  componentWillUnmount() {\n    if (this.seismograph) {\n      this.seismograph.stopRecording();\n    }\n  }\n\n  getDataUrl = range => {\n    let url = currentConfig.dataUrl;\n    if (range) {\n      url += Math.floor(Math.random() * (range - 1) + 1);\n    }\n\n    return url;\n  };\n\n  updateImage = () => {\n    const url = this.getDataUrl(this.state.maxComics);\n    const currentHistory = this.state.history;\n    let lastIndex = this.state.history.length - 1;\n\n    this.fetchPayload(url).then(body => {\n      this.setState({\n        history: currentHistory.concat([body]),\n        currentIndex: ++lastIndex\n      });\n    });\n  };\n\n  fetchPayload = url => {\n    return fetch(url)\n      .then(response => response.json())\n      .then(body => body)\n      .catch(err => console.log(err));\n  };\n\n  prev = () => {\n    let idx = this.state.currentIndex;\n    this.setState({\n      currentIndex: --idx\n    });\n  };\n\n  next = () => {\n    let idx = this.state.currentIndex;\n    this.setState({\n      currentIndex: ++idx\n    });\n  };\n\n  renderComic = payload => {\n    if (payload) {\n      return (\n        <div id={\"imageContainer\"}>\n          <img className={\"comic\"} src={payload.img} alt={payload.alt} />\n          <div id={\"comicName\"}>\n            <span>\n              #{payload.num} | {payload.title}\n            </span>\n          </div>\n        </div>\n      );\n    }\n    return <div id={\"imageContainer\"} />;\n  };\n\n  render = () => {\n    const currentPayload = this.state.history[this.state.currentIndex];\n\n    return (\n      <div id={\"comicContainer\"}>\n        {this.renderComic(currentPayload)}\n        <div className={\"buttongroup\"}>\n          {this.state.currentIndex > 1 && (\n            <button onClick={this.prev}>&lt;</button>\n          )}\n          <button id={\"shuffleBtn\"} onClick={this.updateImage}>\n            Get me another one!\n          </button>\n          {this.state.currentIndex < this.state.history.length - 1 && (\n            <button onClick={this.next}>&gt;</button>\n          )}\n          <div className=\"clearer\" />\n        </div>\n      </div>\n    );\n  };\n}\n","import React from \"react\";\nimport Header from '../header/header'\nimport ImageShaker from '../imageshaker/imageshaker';\n\nexport default class Viewer extends React.Component {\n    // constructor(props) {\n    //     super(props);\n    // }\n\n    render() {\n        return (\n            <div>\n                <Header/>\n                <ImageShaker/>\n            </div>\n        );\n    }\n}\n\n","export const capabilities = {\n    sw: 'serviceWorker' in navigator,\n    idb: 'indexedDB' in window || 'mozIndexedDB' in window || 'webkitIndexedDB' in window || 'msIndexedDB' in window,\n    sync: 'serviceWorker' in navigator && 'SyncManager' in window\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport Viewer from './components/viewer/viewer'\nimport \"./index.css\";\nimport registerServiceWorker from './register-serviceworker';\n\n// ========================================\n\nReactDOM.render(<Viewer/>, document.getElementById(\"root\"));\nregisterServiceWorker();\n","import {capabilities} from './capabilities';\n\nexport default function registerServiceWorker() {\n    console.log('Trying to register service worker.');\n    if (capabilities.sw) {\n        navigator.serviceWorker\n            .register(process.env.PUBLIC_URL + '/sw.js')\n            .then(registration => console.log(\"Successfully registered service worker:\", registration))\n            .catch(err => console.log(\"Failed to register service worker:\", err));\n    } else {\n        console.log('Service workers not supported, skipping registration.');\n    }\n}\n"],"sourceRoot":""}